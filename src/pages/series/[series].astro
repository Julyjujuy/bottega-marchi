---
import Base from "../../layouts/Base.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const all = await getCollection("series");
  return all.map(({ data }) => ({
    params: { series: data.slug },
    props: { s: data },
  }));
}

const { s } = Astro.props;
---
<Base title={`${s.title} â€“ Bottega Marchi`}>
  <main class="page">
    <section class="max-w-[1200px] mx-auto px-6 sm:px-8 md:px-10 lg:px-12">

      {s.description && (
        <div class="quiet mb-8 max-w-prose whitespace-pre-line">
          {s.description}
        </div>
      )}

      <ul class="grid gap-y-14 gap-x-8 sm:grid-cols-2 md:grid-cols-3 lg:gap-x-12">
        {s.pieces.map((p) => (
          <li class="group">
            <a href={`/series/${s.slug}/${p.slug}`} class="block">
              <!-- Same approach as piece page: no forced aspect ratio, no crop -->
              <figure class="rounded-2xl overflow-hidden">
                <img
                  src={p.cover}
                  alt={p.title}
                  class="block w-full h-auto rounded-2xl"
                  loading="lazy"
                />
              </figure>

              <p class="mt-4 text-sm leading-tight px-1 sm:px-2">
                <span class="brand">{p.title}</span>
                {p.subtitle && (
                  <>
                    <br />
                    <span class="opacity-80">{p.subtitle}</span>
                  </>
                )}
              </p>
            </a>
          </li>
        ))}
      </ul>
    </section>
  </main>
</Base>
